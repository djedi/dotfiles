#!/bin/bash

SCANS_DIR='/Users/dustin/Documents/PreEvernote'
SEARCHABLE_SCANS_DIR='/Users/dustin/Documents/SearchableScans'


mkdir -p $SEARCHABLE_SCANS_DIR
open $SEARCHABLE_SCANS_DIR

open -a Evernote

for filename in $SCANS_DIR/*.pdf; do
    basename=`basename -a "$filename"`
    echo "Converting $basename"
    newpath="$SEARCHABLE_SCANS_DIR/$basename"
    ocrmypdf --skip-text "$filename" "$newpath" &
done

wait

for newpath in $SEARCHABLE_SCANS_DIR/*.pdf; do
    open -a Evernote "$newpath" 
done

# clean up
for ((i=20;i>=1;i--)); do
    echo "Cleaning up in $i seconds...\r"
    sleep 1
done
echo ""
trash $SCANS_DIR/*.pdf
trash $SEARCHABLE_SCANS_DIR